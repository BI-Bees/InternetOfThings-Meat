# Business Intelligence - InternetOfThings-Meat
##### Philip West Christiansen & Plamen Getsov
##### Fall 2018 - Handin: 07/12/2018

# Table of Contents (TODO)
<!--ts-->
  * [Opstartsguide](#opstartsguide)  
      * [Diagram](#diagram)   
      * [Overordnet design](#overordnet-design)   
          * [Get Credit Score](#get-credit-score)
  * [Opstartsguide](#opstartsguide) 
<!--ts-->

# Introduction

A project revolving around production and consumption of meat, and the process it took us to get to the result. 

# Process

## Collaboration summary

During our collaboration with the Innovation and Entrepreneurship students we have had roughly 2 meetings a week. They would usually explain their ideas in the first one of the week, while in the second we would give them feedback on what we have queried and if they could use the data. We have also had some meeting where we have only discussed innovation topics. Unfortunately, we, as a team, could not focus primarily on a concrete topic, for which we - the consultants, could find dataset to provide a desired output. 

The initial meeting was introductory, when we got to meet their idea related to the Internet of Things in the beginning that had to do also with meat. Later, we elaborated on meat consumption and production around the world.

After 3 consecutive weeks, we had to take initiative in deciding what to work with for our project, so we picked the topic of meat. As a product of our project we aim to present a map with a list of countries for which we have a value for both consumption and production on the measure - kilogram per capita. As well as a graph with tendencies of the same values for the next few years.

## Meetings

In this section we will go over the meetings we have had with our Innovation and Entrepreneurship group.

After each of our meetings we have taken what was decided and tried to find data supporting their ideas.

### 31/10/2018 - Introduction meeting 

We were introduced to many different ideas during the introduction meeting that took place this day. Generally the Innovation and Entrepreneurship students did not have a very good idea, of what they wanted us to help them with. Some groups had very creative and unrealistic ideas, some had no idea what they wanted and some had ideas that were still relatively unrealistic but if pushed in the right direction ideas that could actually work.

The group that caught our attention, wanted to do something with Meat and Internet of Things. They did not at this point have more than a couple of ideas, as to what they believed could be cool implementation. 

One of the ideas was an an App that could monitor people’s eating habits in their homes. An App that would look into people’s refrigerators, so that they would know what people was eating and what they were throwing out. The idea sounded awesome, but it would not be something we could help them within the time-limit of this project. The assignment was not to create an application that could be installed in people’s houses, it was to analyze some data based on queries they would generate. 

One of the more realistic ideas they had was figuring out how much meat is bought in danish supermarkets. This would be a more realistic approach and something where we could, if data supporting the query was found, actually do some analysing. We got very enthusiastic because this was one of the only things we had heard all day that actually seemed doable. 

At the end of the meeting we agreed upon using Facebook Messenger for further communication. See section “Contact forum” for more information. And we planned a date for the first official meeting for next week. For next time they wanted us to think about ideas that would fit within our project, that supports data about food consumption, meat production and other things we thought could be interesting corresponding to meat. 

### 07/11/2018 - First official meeting 

This was a short 10-minute update meeting. We both told each other what we had thought about. We might have helped them a bit in changing the subject to “Production of Meat”. We believed it would be easier to find data supporting that. They wanted us to see if we could find data supporting the subject for next meeting. We planned a meeting for next week. 

### 12/11/2018 - Showing of results, subject change RFID and LIFI

The meeting started off by us showing them the different data we had found. Showing them various CSV-files showing food production in the world, statistics showing how likely people are to changing their meat eating habits estimated meat production in the next 10 years and much more. We showed them how we were able to obtain the various data-sets we found, by showing them Google queries and the different websites we were looking at. They had generated a document with a problem statement and various tags within the subject Internet of Things. The problem statement said:

*“Using RFID tags and LIFI to streamline the supply chain (select category) in upstream and downstream inventories in Danish supermarkets”*

They told us that they now wanted us to focus on food waste in danish supermarkets. We could ourselve select the category as seen above in the problem statement, whatever would be easiest to find data supporting. This of course made it a little harder for us because most of the data we had already found was now mostly unusable. We agreed upon a meeting next week. For the next meeting they would try and specify their problem statement more and we would try and find data yet again for the new direction they wanted to go. 

### 14/11/2018 - Showing of results, subject change foodwaste

The meetings started off by us showing the data we were able to find on the problem statement above. Apparently that had gotten another idea where the main topic would be food waste in Danish supermarkets. Their idea was to take a more innovative approach to how barcodes on various food items function. 

Today it only shows the identification number of the product, but what if it could show stuff like expiry dates so that they somehow could link that to food waste in Danish supermarkets. 

### 19/11/2018 - Showing our results, subject change to *Countries with most frequent RFID use*

Once again we showed the data we had found. But now they wanted us to find data that would help them find out which countries use RFID the most. Their idea was that maybe this would be written in articles and such. Perhabs this is where we could find such data. 

They also wanted to find data showing which countries today are most advanced in LIFI. 

### 22/11/2018 - Subject change back to original subject 

After consulting with our counselor we decided to go back to the original idea that was production and consumption of meat worldwide. This subject we already had data support and it would therefore actually be a subject where we finally could start programming. 

Our goal was to create a world-map showing the production and consumption of meat in a specific year. They were totally onboard with the idea and said it would be cool and that it would be something that they actually could use in their report too. This could be tied together with food waste and therefore beneficial to their new subject. 

### 29/11/2018 - Update meeting 

Showing them our results from the production and consumption of meat datasets. Showing them different graph and explaining different ideas. They told us what they wanted to use our data for. 

## Contact forum

We agreed upon using Facebook Messenger as a contact forum. The decision was made because everyone in our group from both parties already uses Facebook Messenger. Selina Açıkel from the Innovation and Entrepreneurship course created the group and invited everyone. Below is a screenshot of the beginning of the group-chat. 

![alt text](https://github.com/BI-Bees/InternetOfThings-Meat/blob/master/images/contact_forum.png "Contact forum")

# Contract

This is the contract agreed upon from both Software-Developers and Innovation & Entrepreneurshipers.

## Product

The final product should show a world-map with different countries highlighed showing meat production and consumption, from a specific year within 1991-2013, based on data accumulated from OECD and FAOSTAT datasets. A non-specific chart should also be shown showcasing the evolution of total both meat production and consumption within the specified years. 


## Pricing

Consulting price set for: **1000 DKK / HOUR** *per person*

## Team

**Software-Developers**

- Philip West Christiansen
- Plamen Getsov

**Innovation & Entrepreneurship**

- Selina Açıkel
- Betul Dal
- Hamid Popal
- Mohammed Samrawi

## Delivery date

Delivery is scheduled for friday the **7th** of **december 2018** at **12 am**.

# Billing

Billing set at: **1000 DKK / HOUR** *per person*

**Meetings**

| Date | Description | Hours | Price DKK |
| ------------- | ------------- | ------------- | ------------- |
| 31/10/2018 | Introduction meeting | 2 | Free |
| 07/11/2018 | First official meeting, update meeting | 0,5 | 1000 |
| 12/11/2018 | Sharing our results + subject change to RFID and LIFI | 0,5 | 1000 |
| 14/11/2018 | Sharing our results + subject change to barcodes and foodwaste | 0,5 | 1000 |
| 19/11/2018 | Sharing our results + subject change to countries with most frequest RFID use | 0,5 | 1000 |
| 22/11/2018 | Subject change, going back to meat production and consumption | 0,5 | 1000 |
| 29/11/2018 | Sharing our results, planning for delivery | 1 | 1000 |

**Work**

| Date | Hours | Price DKK |
| ------------- | ------------- | ------------- |
| 01/11/2018 | 5,5 | 11000 |
| 08/11/2018 | 5,5 | 11000 |
| 15/11/2018 | 5,5 | 11000 |
| 22/11/2018 | 5,5 | 11000 |
| 29/11/2018 | 5,5 | 11000 |

**Furthermore work**

| Hours | Price DKK |
| ------------- | ------------- | 
| 30 | 30000 |

**Total billing**

| Title | Price DKK |
| ------------- | ------------- | 
| Meetings | 6000 |
| Work | 55000 |
| Furthermore work | 30000 |
| **Total** | **91000** |

# Final product

Goes here...
    
# User documentation

User link: [![Binder](https://mybinder.org/badge_logo.svg)](https://mybinder.org/v2/gh/BI-Bees/InternetOfThings-Meat/master)

# Data sources

Below is listed all the different datasources used in this project:

**OECD Data**
- Description: Meat consumption around the world. 
- Usage: We got a big CSV file that we formatted into something we could use for the project. 
- Link: https://data.oecd.org/agroutput/meat-consumption.htm

**FAOSTAT - Food and Agriculture Organization of the United Nations**
- Description: Meat production around the world. 
- Usage: We got a big CSV file that we formatted into something we could use for the project. 
- Link: http://www.fao.org/faostat/en/#data/CL

*Below are images that shows data chosen in order to get the output we recived*

![alt text](https://github.com/BI-Bees/InternetOfThings-Meat/blob/master/images/FAOSTAT_image1.png "FAOSTAT img1")
![alt text](https://github.com/BI-Bees/InternetOfThings-Meat/blob/master/images/FAOSTAT_image2.png "FAOSTAT img2")

# Technical documentation

## Datasets formatting

We have various datasets that can be seen in the dataset folder. 

![alt text](https://github.com/BI-Bees/InternetOfThings-Meat/blob/master/images/datasets.png "Dataset")

### Formatting original datasets

We started off with the *original_production.csv* and *original_consumption.csv* CSV files/datasets. Both these datasets shows kg/pr/capita of meat either produced or consumed from year x to y in a specific country. Both these files contained more information than we needed. 

Both files showed different kind of meats, we just wanted a sum of all meats, and we did not want all the headers. Therefore we created two new CSV files *modified_production.csv* and *modified_consumption.csv*. These newly created files only have three headers:

| Country | Year | Production or Consumption |
| ------------- | ------------- | ------------- |

Below is a look into the *production_script.py* file that creates the *modified_production.csv* files. 

```python
import csv
import pandas as pd

file_name = "../dataset/original_production.csv"
dataframe = pd.read_csv(file_name, delimiter=",")
lessdata = dataframe[['Country', 'Year', 'Value']]

# Creating lists
country_list = lessdata.Country.unique().tolist()
year_list = lessdata.Year.unique().tolist()


def find_sum(country, year):
    country_mask = lessdata['Country'] == country
    year_mask = lessdata['Year'] == year
    return lessdata[(country_mask) & (year_mask)].Value.sum()


def create_csv():
    with open('../dataset/modified_production.csv', 'w', newline='') as f:
        csv_writer = csv.writer(f)
        csv_writer.writerow(['Country', 'Year', 'Production'])
        for country_row in country_list:
            for year_row in year_list:
                csv_writer.writerow(
                    [country_row, year_row, find_sum(country_row, year_row)])
```
*** *production_script.py* ***

The script takes in the *original_production.csv*, and by using pandas we create a new dataframe with the above mentioned three headers we need. We then have a function: 

```python
def find_sum(country, year):
```
*** *production_script.py* ***

This function finds the sum of meat for a specific country in a specific year. With all this information we can now create create our new csv file by running the following method:

```python
def create_csv():
```
*** *production_script.py* ***

The way we create the *modified_consumption.csv* file is almost the same, see *consumption_script.py* for furthermore reading. 

### joining the datasets

We now want to join our *modified_production.csv* and *modified_consumption.csv* files. We want to do this because we actually have different countries and different years in the two files. *modified_production.csv* have more countries listed than *modified_consumption.csv* for example, and we do not want this. 

Therefore we are using *pandas.merge* function that makes us able to merge our two files together based on matching-parameters as shown below:

```python
matching_data = pd.merge(left=production, right=consumption, on=['Country','Year'])
matching_data.to_csv('../dataset/joined.csv', sep =',')
```
*** *joined_script.py* ***

We now have a new CSV file *joined.csv* that only contains countries and years that match our two files. 

In order to make our dataset usable with pygal we need to have one more header that shows us the country-code for the specific country. Therefore we need to merge with one more file. This is shown below: 

```python
matching_data2 = pd.merge(left=joined, right=countries, on=['Country'])
matching_data2.to_csv('../dataset/joined_w_countries.csv', sep =',')
```
*** *joined_script.py* ***

![alt text](https://github.com/BI-Bees/InternetOfThings-Meat/blob/master/images/mergeddata.png "Merged Dataset")


## Graphs

We are *pygal* to help us display our data in graphs. We have used *Jupyter Notebook* to render our graphs aswell. The code below generates a world-map.

```python
def generate_map(year):
    worldmap_chart = pygal.maps.world.World()
    worldmap_chart.title = 'Production vs Consumption - Year ' + year
    with open(data_file_name) as f:
        reader = csv.reader(f)
        for row in reader:
            if(row[3] == year):
                worldmap_chart.add(row[2], {
                str(row[6].lower()): [row[4], row[5]]
            })
        worldmap_chart.render_in_browser()
```
*** *Map.ipynb* ***

The *def* takes in a *year* parameter and then plots all countries in the dataset and their production vs consumption on a big world-map, as shown below:

![alt text](https://github.com/BI-Bees/InternetOfThings-Meat/blob/master/images/worldmap.png "Merged Dataset")

This solves the first problem of our **Product** section in our **Contract**. The next is we want to show average production and consumption over the years. We have done this with a linechart. The code is as follows:

```python
def total_production(year):
    total_production = 0.0
    sum = 0
    firstline = True
    with open(data_file_name) as f:
        reader = csv.reader(f)
        for row in reader:
            if firstline:
                firstline = False
                continue
            if(int(row[3]) == year):
                total_production += float(row[4])
                sum = sum + 1
    return total_production / sum

def total_consumption(year):
    total_consumption = 0.0
    sum = 0
    firstline = True
    with open(data_file_name) as f:
        reader = csv.reader(f)
        for row in reader:
            if firstline:
                firstline = False
                continue
            if(int(row[3]) == year):
                total_consumption += float(row[5])
                sum = sum + 1
    return total_consumption / sum

def line_chart():
    line_chart = pygal.Line()
    line_chart.title = 'Prodcution and Consumption over the years'
    line_chart.x_labels = map(str, range(1991, 2014))
    line_chart.add('Production', [total_consumption(1991), total_consumption(1992), total_consumption(1993), total_consumption(1994), total_consumption(1995), total_consumption(1996), total_consumption(1997), total_consumption(1998), total_consumption(1999), total_consumption(2000), total_consumption(2001), total_consumption(2002), total_consumption(2003), total_consumption(2004), total_consumption(2005), total_consumption(2006), total_consumption(2007), total_consumption(2008), total_consumption(2009), total_consumption(2010), total_consumption(2011), total_consumption(2012), total_consumption(2013)])
    line_chart.add('Consumption',  [total_production(1991), total_production(1992), total_production(1993), total_production(1994), total_production(1995), total_production(1996), total_production(1997), total_production(1998), total_production(1999), total_production(2000), total_production(2001), total_production(2002), total_production(2003), total_production(2004), total_production(2005), total_production(2006), total_production(2007), total_production(2008), total_production(2009), total_production(2010), total_production(2011), total_production(2012), total_production(2013)])
    line_chart.render_in_browser()
```
*** *Map.ipynb* ***

![alt text](https://github.com/BI-Bees/InternetOfThings-Meat/blob/master/images/linechart.png "Merged Dataset")

This now solves our other problem.

# Other sources

I am thinking here we add all of our other sources we found and the google queries etc?
